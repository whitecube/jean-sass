@use "sass:map";
@use "sass:list";
@use "../config/global" as *;
@use "../tools/functions/str-split" as *;
@use "../tools/functions/str-split" as *;

// Merge $value in the key: $key
@mixin merge($key, $value) {
  $config: map.deep-merge(
    $config,
    (
      $key: $value,
    )
  ) !global;
}

// - @include config.set( $key: string, $value: mixed)
// **********************************************************
// set a value in the $config array.
// example:
//   @include config.set('grid.unit', $value) => (grid:(unit: $value));
//   @include config.set('grid', (unit: $value), true) => (grid:(unit: $value));
//  The $merge:true attribute allows you to set up a whole array of values.
// **********************************************************
@mixin set($key, $value) {
  $args: list.append(str-split($key, "."), $value);
  $config: map.set($config, $args...) !global;
}

// Get the config value by dotted synthax key.
@function get($key) {
  $keys: str-split($key, ".");
  $value: map.get($config, $keys...);

  @if $key== "*" {
    @return $config;
  }

  @if map.has-key($config, $keys...) {
    @return $value;
  }

  @error ('The configuration map doesn\'t have a #{$key} key.');
}

// Check if a value exist in the config
@function exist($key) {
  $keys: str-split($key, ".");
  $value: map.get($config, $keys...);
  @return map.has-key($config, $keys...);
}
